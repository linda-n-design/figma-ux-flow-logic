<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UX Flow Logic (beta)</title>
  <style>
    :root {
      /* Light Mode Colors */
      --color-bg-light: #FFFFFF;
      --color-text-light: #303030;
      --color-text-secondary-light: #767676;
      --color-border-light: #D9D9D9;
      --color-border-input-light: #CCCCCC;
      --color-interactive-light: #0070C0;
      --color-input-bg-light: #FFFFFF;
      --color-primary: #0070C0;
      --color-white: #FFFFFF;
      
      /* Dark Mode Colors */
      --color-bg-dark: #01243E;
      --color-text-dark: #F3F3F3;
      --color-text-secondary-dark: #CCCCCC;
      --color-border-dark: #3D3D3D;
      --color-border-input-dark: #5A5A5A;
      --color-interactive-dark: #D0CF94;
      --color-input-bg-dark: #002642;
      
      /* Spacing */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 12px;
      --spacing-lg: 16px;
      --spacing-xl: 24px;
      
      /* Typography */
      --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      --font-size-small: 14px;
      --font-size-base: 16px;
      --font-size-subheading: 20px;
      
      /* Border Radius */
      --radius-sm: 8px;
      --radius-pill: 20px;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      line-height: 1.4;
      background-color: var(--color-bg-light);
      color: var(--color-text-light);
      overflow: hidden;
    }
    
    body.dark-mode {
      background-color: var(--color-bg-dark);
      color: var(--color-text-dark);
    }
    
    .plugin-container {
      width: 400px;
      height: 600px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .content-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .content-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      overflow-x: hidden;
    }
    
    .content-inner {
      padding: var(--spacing-lg) 0;
      display: flex;
      flex-direction: column;
      gap: var(--spacing-xl);
      flex: 1;
    }
    
    /* Detail screen specific spacing */
    #detailScreen .content-inner {
      padding-top: var(--spacing-xl);
    }
    
    /* Tabs */
    .top-area {
      border-bottom: 1px solid var(--color-border-light);
      padding: var(--spacing-sm) var(--spacing-md) 0;
    }
    
    body.dark-mode .top-area {
      border-bottom-color: var(--color-border-dark);
    }
    
    .tabs {
      display: flex;
      gap: 0;
    }
    
    .tab {
      padding: var(--spacing-sm) var(--spacing-lg) var(--spacing-xs);
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
      cursor: pointer;
      font-family: var(--font-family);
      font-size: var(--font-size-small);
      font-weight: 400;
      color: var(--color-text-secondary-light);
      transition: all 0.2s;
      white-space: nowrap;
    }
    
    body.dark-mode .tab {
      color: var(--color-text-secondary-dark);
    }
    
    .tab:hover {
      background-color: rgba(0, 0, 0, 0.03);
    }
    
    body.dark-mode .tab:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    
    .tab.active {
      font-weight: 600;
      color: var(--color-interactive-light);
      border-bottom-color: var(--color-interactive-light);
    }
    
    body.dark-mode .tab.active {
      color: var(--color-interactive-dark);
      border-bottom-color: var(--color-interactive-dark);
    }
    
    /* Theme Toggle */
    .theme-toggle-section {
      padding: var(--spacing-md) var(--spacing-xl);
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
    }
    
    .theme-label {
      font-size: var(--font-size-small);
      font-weight: 600;
      color: #1E1E1E;
    }
    
    body.dark-mode .theme-label {
      color: #F3F3F3;
    }
    
    .theme-toggle {
      display: flex;
      border: 1px solid #757575;
      border-radius: var(--radius-sm);
      overflow: hidden;
    }
    
    body.dark-mode .theme-toggle {
      border-color: #757575;
    }
    
    .theme-btn {
      padding: var(--spacing-sm);
      background: var(--color-white);
      border: none;
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      font-weight: 400;
      cursor: pointer;
      transition: all 0.2s;
      color: #1E1E1E;
      white-space: nowrap;
      height: 32px;
      min-width: fit-content;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    body.dark-mode .theme-btn {
      background: #01243E;
      color: #F3F3F3;
    }
    
    .theme-btn:first-child {
      border-right: 1px solid #757575;
    }
    
    .theme-btn.selected {
      background-color: var(--color-primary);
      color: var(--color-white);
      font-weight: 600;
    }
    
    body.dark-mode .theme-btn.selected {
      background-color: var(--color-primary);
      color: var(--color-white);
      font-weight: 600;
    }
    
    /* Content Sections */
    .content-section {
      padding: 0 var(--spacing-xl);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
    }
    
    .content-section.fill {
      flex: 1;
      min-height: 0;
    }
    
    .section-title {
      font-size: var(--font-size-subheading);
      font-weight: 400;
      line-height: 1.2;
    }
    
    .section-text {
      font-size: var(--font-size-base);
      line-height: 1.4;
    }
    
    /* Input Field */
    .input-group {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }
    
    .input-label {
      font-size: var(--font-size-base);
      color: var(--color-text-light);
    }
    
    body.dark-mode .input-label {
      color: var(--color-text-dark);
    }
    
    .text-input {
      width: 100%;
      padding: var(--spacing-sm) var(--spacing-md);
      border: 1px solid var(--color-border-input-light);
      border-radius: var(--radius-sm);
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      background-color: var(--color-input-bg-light);
      color: var(--color-text-light);
      transition: all 0.2s;
    }
    
    body.dark-mode .text-input {
      border-color: var(--color-border-input-dark);
      background-color: var(--color-input-bg-dark);
      color: var(--color-text-dark);
    }
    
    .text-input:focus {
      outline: none;
      border-color: var(--color-interactive-light);
    }
    
    body.dark-mode .text-input:focus {
      border-color: var(--color-interactive-dark);
    }
    
    /* Textarea */
    .textarea-group {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
      flex: 1;
      min-height: 0;
    }
    
    .textarea-field {
      width: 100%;
      flex: 1;
      padding: var(--spacing-sm) var(--spacing-md);
      border: 1px solid var(--color-border-input-light);
      border-radius: var(--radius-sm);
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      background-color: var(--color-input-bg-light);
      color: var(--color-text-light);
      resize: none;
      transition: all 0.2s;
    }
    
    body.dark-mode .textarea-field {
      border-color: var(--color-border-input-dark);
      background-color: var(--color-input-bg-dark);
      color: var(--color-text-dark);
    }
    
    .textarea-field:focus {
      outline: none;
      border-color: var(--color-interactive-light);
    }
    
    body.dark-mode .textarea-field:focus {
      border-color: var(--color-interactive-dark);
    }
    
    /* Menu List */
    .menu-list {
      display: flex;
      flex-direction: column;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--spacing-md) 0;
      border-bottom: 1px solid var(--color-border-light);
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    body.dark-mode .menu-item {
      border-bottom-color: var(--color-border-dark);
    }
    
    .menu-item:hover {
      background-color: rgba(0, 0, 0, 0.02);
    }
    
    body.dark-mode .menu-item:hover {
      background-color: rgba(255, 255, 255, 0.03);
    }
    
    .menu-item:last-child {
      border-bottom: none;
    }
    
    .menu-label {
      font-size: var(--font-size-base);
      color: var(--color-text-light);
    }
    
    body.dark-mode .menu-label {
      color: var(--color-text-dark);
    }
    
    .menu-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }
    
    .menu-icon path {
      stroke: var(--color-text-secondary-light);
    }
    
    body.dark-mode .menu-icon path {
      stroke: var(--color-text-secondary-dark);
    }
    
    /* Buttons */
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-md) var(--spacing-sm);
      border-radius: var(--radius-sm);
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      font-weight: 400;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      background: none;
    }
    
    .btn-primary {
      background-color: var(--color-primary);
      color: var(--color-text-dark);
      font-weight: 600;
    }
    
    .btn-primary:hover {
      opacity: 0.9;
    }
    
    .btn-secondary {
      border: 1px solid var(--color-interactive-light);
      background-color: var(--color-bg-light);
      color: var(--color-interactive-light);
    }
    
    body.dark-mode .btn-secondary {
      border-color: #A5CECF;
      background-color: var(--color-bg-dark);
      color: #A5CECF;
    }
    
    .btn-secondary:hover {
      background-color: rgba(0, 112, 192, 0.05);
    }
    
    body.dark-mode .btn-secondary:hover {
      background-color: rgba(208, 207, 148, 0.1);
    }
    
    .btn-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    
    .btn-secondary .btn-icon path {
      stroke: var(--color-interactive-light);
    }
    
    body.dark-mode .btn-secondary .btn-icon path {
      stroke: #A5CECF;
    }
    
    /* Footer */
    .sticky-footer {
      padding: var(--spacing-xl);
      border-top: 1px solid var(--color-border-light);
      background-color: var(--color-bg-light);
      display: flex;
      gap: var(--spacing-sm);
    }
    
    body.dark-mode .sticky-footer {
      border-top-color: var(--color-border-dark);
      background-color: var(--color-bg-dark);
      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3);
    }
    
    .sticky-footer .btn {
      flex: 1;
    }
    
    /* Screen visibility */
    .screen {
      display: none;
      flex-direction: column;
      height: 100%;
    }
    
    .screen.active {
      display: flex;
    }
    
    /* Utility */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="plugin-container">
    <div class="content-wrapper">
      <!-- Summary Screen -->
      <div id="summaryScreen" class="screen active">
        <!-- Tabs -->
        <div class="top-area">
          <div class="tabs" role="tablist">
            <button class="tab active" role="tab" data-screen="summary">
              Summary
            </button>
            <button class="tab" role="tab" data-screen="define">
              Define flow steps
            </button>
          </div>
        </div>
        
        <div class="content-area">
          <div class="content-inner">
            <!-- Theme Toggle -->
            <div class="theme-toggle-section">
              <span class="theme-label">Theme</span>
              <div class="theme-toggle">
                <button type="button" class="theme-btn selected" id="lightModeBtn">‚òÄÔ∏è Light mode</button>
                <button type="button" class="theme-btn" id="darkModeBtn">üåô Dark mode</button>
              </div>
            </div>
            
            <!-- Flow Name Input -->
            <div class="content-section">
              <div class="input-group">
                <label class="input-label" for="flowName">Name of the flow</label>
                <input type="text" id="flowName" class="text-input" placeholder="">
              </div>
            </div>
            
            <!-- Menu Items -->
            <div class="content-section">
              <div class="menu-list">
                <div class="menu-item" data-detail="trigger">
                  <span class="menu-label">Add Trigger</span>
                  <svg class="menu-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7.5 15L12.5 10L7.5 5" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="menu-item" data-detail="assumptions">
                  <span class="menu-label">Add Assumptions</span>
                  <svg class="menu-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7.5 15L12.5 10L7.5 5" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="menu-item" data-detail="preconditions">
                  <span class="menu-label">Add Pre-Conditions</span>
                  <svg class="menu-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7.5 15L12.5 10L7.5 5" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="menu-item" data-detail="postconditions">
                  <span class="menu-label">Add Post-Conditions</span>
                  <svg class="menu-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7.5 15L12.5 10L7.5 5" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="sticky-footer">
          <button class="btn btn-primary" id="initializeBtn">
            Initialize flow
          </button>
        </div>
      </div>
      
      <!-- Define Flow Steps Screen -->
      <div id="defineScreen" class="screen">
        <!-- Tabs -->
        <div class="top-area">
          <div class="tabs" role="tablist">
            <button class="tab" role="tab" data-screen="summary">
              Summary
            </button>
            <button class="tab active" role="tab" data-screen="define">
              Define flow steps
            </button>
          </div>
        </div>
        
        <div class="content-area">
          <div class="content-inner">
            <div class="content-section fill">
              <div class="textarea-group">
                <label class="input-label" for="flowSteps">Initial flow steps outline</label>
                <textarea id="flowSteps" class="textarea-field" placeholder=""></textarea>
              </div>
            </div>
          </div>
        </div>
        
        <div class="sticky-footer">
          <button class="btn btn-primary" id="initializeBtn2">
            Initialize flow
          </button>
        </div>
      </div>
      
      <!-- Detail Screen (for Add/Edit) -->
      <div id="detailScreen" class="screen">
        <div class="content-area">
          <div class="content-inner">
            <div class="content-section">
              <h2 class="section-title" id="detailTitle">Add Trigger</h2>
            </div>
            
            <div class="content-section fill">
              <div class="textarea-group">
                <label class="input-label" for="detailTextarea" id="detailLabel">Trigger</label>
                <textarea id="detailTextarea" class="textarea-field" placeholder=""></textarea>
              </div>
            </div>
          </div>
        </div>
        
        <div class="sticky-footer">
          <button class="btn btn-secondary" id="cancelBtn">
            Cancel
          </button>
          <button class="btn btn-primary" id="saveBtn">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // State management
    const appState = {
      mode: 'light',
      currentScreen: 'summary',
      currentDetail: null,
      flowName: '',
      flowSteps: '',
      trigger: '',
      assumptions: '',
      preconditions: '',
      postconditions: ''
    };
    
    // Theme handling
    function setMode(mode) {
      appState.mode = mode;
      document.body.className = mode === 'dark' ? 'dark-mode' : '';
      
      const lightBtn = document.getElementById('lightModeBtn');
      const darkBtn = document.getElementById('darkModeBtn');
      
      if (mode === 'light') {
        lightBtn.classList.add('selected');
        darkBtn.classList.remove('selected');
      } else {
        darkBtn.classList.add('selected');
        lightBtn.classList.remove('selected');
      }
    }
    
    // Screen navigation
    function showScreen(screenName) {
      appState.currentScreen = screenName;
      
      // Hide all screens
      document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.remove('active');
      });
      
      // Show selected screen
      const screenMap = {
        'summary': 'summaryScreen',
        'define': 'defineScreen',
        'detail': 'detailScreen'
      };
      
      document.getElementById(screenMap[screenName]).classList.add('active');
      
      // Update tabs
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.screen === screenName) {
          tab.classList.add('active');
        }
      });
    }
    
    // Detail screen handling
    function showDetail(detailType) {
      appState.currentDetail = detailType;
      
      const hasContent = appState[detailType] && appState[detailType].trim() !== '';
      const prefix = hasContent ? 'Edit' : 'Add';
      
      const titles = {
        'trigger': `${prefix} Trigger`,
        'assumptions': `${prefix} Assumptions`,
        'preconditions': `${prefix} Pre-Conditions`,
        'postconditions': `${prefix} Post-Conditions`
      };
      
      const labels = {
        'trigger': 'Trigger',
        'assumptions': 'Assumptions',
        'preconditions': 'Pre-Conditions',
        'postconditions': 'Post-Conditions'
      };
      
      document.getElementById('detailTitle').textContent = titles[detailType];
      document.getElementById('detailLabel').textContent = labels[detailType];
      document.getElementById('detailTextarea').value = appState[detailType] || '';
      
      showScreen('detail');
    }
    
    function saveDetail() {
      if (appState.currentDetail) {
        appState[appState.currentDetail] = document.getElementById('detailTextarea').value;
        updateMenuLabels(); // Update labels after saving
      }
      showScreen('summary');
    }
    
    function cancelDetail() {
      showScreen('summary');
    }
    
    // Update menu item labels based on whether content exists
    function updateMenuLabels() {
      const menuItems = {
        'trigger': document.querySelector('[data-detail="trigger"] .menu-label'),
        'assumptions': document.querySelector('[data-detail="assumptions"] .menu-label'),
        'preconditions': document.querySelector('[data-detail="preconditions"] .menu-label'),
        'postconditions': document.querySelector('[data-detail="postconditions"] .menu-label')
      };
      
      const labels = {
        'trigger': 'Trigger',
        'assumptions': 'Assumptions',
        'preconditions': 'Pre-Conditions',
        'postconditions': 'Post-Conditions'
      };
      
      Object.keys(menuItems).forEach(key => {
        const hasContent = appState[key] && appState[key].trim() !== '';
        const prefix = hasContent ? 'Edit' : 'Add';
        if (menuItems[key]) {
          menuItems[key].textContent = `${prefix} ${labels[key]}`;
        }
      });
    }
    
    // Update app state from input fields
    function updateState() {
      appState.flowName = document.getElementById('flowName').value;
      appState.flowSteps = document.getElementById('flowSteps').value;
    }
    
    // Event listeners
    document.getElementById('lightModeBtn').addEventListener('click', () => setMode('light'));
    document.getElementById('darkModeBtn').addEventListener('click', () => setMode('dark'));
    
    // Tab navigation
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const screen = tab.dataset.screen;
        showScreen(screen);
      });
    });
    
    // Menu items navigation
    document.querySelectorAll('.menu-item').forEach(item => {
      item.addEventListener('click', () => {
        const detailType = item.dataset.detail;
        showDetail(detailType);
      });
    });
    
    // Detail screen buttons
    document.getElementById('cancelBtn').addEventListener('click', cancelDetail);
    document.getElementById('saveBtn').addEventListener('click', saveDetail);
    
    // Input handling - update state when fields change
    document.getElementById('flowName').addEventListener('input', updateState);
    document.getElementById('flowSteps').addEventListener('input', updateState);
    
    // Initialize buttons (send message to plugin code)
    document.getElementById('initializeBtn').addEventListener('click', () => {
      parent.postMessage({
        pluginMessage: {
          type: 'initialize-flow',
          data: {
            flowName: appState.flowName,
            trigger: appState.trigger,
            assumptions: appState.assumptions,
            preconditions: appState.preconditions,
            postconditions: appState.postconditions,
            flowSteps: appState.flowSteps,
            theme: appState.mode
          }
        }
      }, '*');
    });
    
    document.getElementById('initializeBtn2').addEventListener('click', () => {
      parent.postMessage({
        pluginMessage: {
          type: 'initialize-flow',
          data: {
            flowName: appState.flowName,
            trigger: appState.trigger,
            assumptions: appState.assumptions,
            preconditions: appState.preconditions,
            postconditions: appState.postconditions,
            flowSteps: appState.flowSteps,
            theme: appState.mode
          }
        }
      }, '*');
    });
    
    // Initialize UI on load
    setMode('light');
    showScreen('summary');
  </script>
</body>
</html>